---
author: [[Chris Riccomini]]
title: "Unpacking the Buzz Around ClickHouse"
date: 2024-11-18
tags: 
- articles
- literature-note
---
![rw-book-cover](https://substackcdn.com/image/fetch/w_1200,h_600,c_fill,f_jpg,q_auto:good,fl_progressive:steep,g_auto/https%3A%2F%2Fsubstack-post-media.s3.amazonaws.com%2Fpublic%2Fimages%2F6be7c97e-357e-4b01-bc15-ee0c0dd5cca1_1024x1024.webp)

## Metadata
- Author: [[Chris Riccomini]]
- Full Title: Unpacking the Buzz Around ClickHouse
- URL: https://materializedview.io/p/unpacking-the-buzz-around-clickhouse

## Highlights
- My two previous posts, 15 Years of Realtime OLAP ([part 1](https://materializedview.io/p/15-years-of-realtime-olap-part-1), [part 2](https://materializedview.io/p/15-years-of-realtime-olap-part-2)), documented my experience with home-grown realtime OLAP systems, [Apache Druid](https://druid.apache.org/), and Apache Pinot. I also discussed the use cases I had for these systems: user facing product analytics and fraud detection. My intent was to lay the foundation for this post, where I investigate the buzz around [ClickHouse](https://clickhouse.com/). ([View Highlight](https://read.readwise.io/read/01jd0f2kznbayy267e72fy4g1h))
- ClickHouse has been appearing a lot in some of my recent interactions. [Tinybird](https://www.tinybird.co/), a user-facing analytics product, uses ClickHouse as its database. Several startups I’ve talked to are working on ClickHouse-related products. My Twitter feed has a lot of ClickHouse mentions, too. ([View Highlight](https://read.readwise.io/read/01jd0f2qqeygsqjc9kvw4rf5qs))
- What’s more, much of the feedback about ClickHouse appears to be quite positive, too. This caught my eye—we engineers tend to be a critical bunch. Moreover, when I looked at ClickHouse, I saw another realtime OLAP system like Druid or Pinot. Why all the attention? ([View Highlight](https://read.readwise.io/read/01jd0f2ynk589jhjy5dyddsard))
- The responses to this post were interesting. The feedback seems to boil down to three things: speed, ease of install, and ease of operations. ([View Highlight](https://read.readwise.io/read/01jd0f37yxvxajaa78mkkq4ft5))
- ClickHouse is indeed very fast. A friend told me, “They have the mentality of a team on a budget. Like they didn’t have 1000s of machines to throw at the problem. They had to make it work on what they had.” This might or might not be true—ClickHouse [comes from Yandex](https://clickhouse.com/blog/introducing-click-house-inc)—but the software definitely has this vibe. ([View Highlight](https://read.readwise.io/read/01jd0f3a7q4vettgacghdafk9b))
## New highlights added November 18, 2024 at 10:38 PM
- As proof, ClickHouse runs a [benchmark project](https://benchmark.clickhouse.com/). Database vendors may submit their databases to see how they fair. ClickHouse has been dominating its competition (at least until 6 months ago when [Umbra](https://umbra-db.com/) [showed up](https://benchmark.clickhouse.com/)). One can quibble over the workloads tested, but ClickHouse is clearly a very fast database. ([View Highlight](https://read.readwise.io/read/01jd0f3ka9ex1neszgk7prw0q4))
- Though speed is nice, it’s [not as important](https://motherduck.com/blog/perf-is-not-enough/) as it used to be. Where ClickHouse really shines is its installation experience. Realtime OLAP systems are notoriously annoying to get running. Apache Druid and Apache Pinot both use bash scripts that spawn multiple local JVM-based services to get the system up and running. Either that or you’ve got to run Docker and use Helm charts, as is [the case with StarRocks](https://docs.starrocks.io/docs/quick_start/shared-nothing/). ([View Highlight](https://read.readwise.io/read/01jd0f3v8bztt1akedvct7sf3b))
- ClickHouse, by contrast, is a single cURL command to [clickhouse.com](https://clickhouse.com). The server is smart enough that it recognizes the lack of user-agent in the HTTP request and automatically gives you a bash script to install a native binary for your host. It just works. ([View Highlight](https://read.readwise.io/read/01jd0f429rbevj3y850gkec56b))
- They’ve occupied a really nice spot between embedded OLAP systems like [DuckDB](https://duckdb.org/) and distributed realtime OLAP systems like Apache Pinot and Apache Druid. It’s surprising to me that there aren’t more single-process realtime OLAP systems out there; it seems obvious in hindsight. ClickHouse seems unique in this regard, aside from recent [PostgreSQL](https://www.postgresql.org/) OLAP developments (more on this later). ([View Highlight](https://read.readwise.io/read/01jd0f44xh762kg7zwaxnskehe))
- Another way of phrasing all this is that the developer experience (DX) is really nice. And a great developer experience leads to a lot of rave reviews on Twitter. I suspect this is where a lot of the buzz is coming from. ([View Highlight](https://read.readwise.io/read/01jd0f48vrbj5t45bbcsxrpa5s))
- A great DX is nice and all, but does it scale and is it easy to operate? Here too, the feedback is positive, but more mixed. ClickHouse’s speed and efficiency mean it can scale up quite nicely—you can continue to run it on one big machine for quite a while. ([View Highlight](https://read.readwise.io/read/01jd0f4dd3d9dv1n8rkj49s65j))
- Once you’re ready to move beyond one machine, you’ll need to introduce another ClickHouse service: [ClickHouse Keeper](https://clickhouse.com/blog/clickhouse-keeper-a-zookeeper-alternative-written-in-cpp). Here, too, the developer experience is excellent. ClickHouse used to rely on ZooKeeper to coordinate its nodes in a distributed environment. Running ZooKeeper is tough, so ClickHouse wrote their own drop-in replacement, which they bundle [bundle into their binary](https://clickhouse.com/docs/en/guides/sre/keeper/clickhouse-keeper#how-to-run). ([View Highlight](https://read.readwise.io/read/01jd0f4fr9ndnnxtn51fm36dq5))
- The operational flexibility to scale up or out without adding a bunch of services is really valuable. And it’s run on some very large workloads. Tinybird has some customers [doing 300K-600K events per second](https://www.tinybird.co/blog-posts/how-tinybird-scales). [Uber](https://uber.com/) adopted ClickHouse for their [log analytics platform](https://www.uber.com/blog/logging/) (more on this later, too). And I assume Yandex’s usage is still fairly large. ([View Highlight](https://read.readwise.io/read/01jd0f4mcj4zxwbt9h5syvnzfs))
- As nice as ClickHouse appears to be, I see a few challenges. The first and most significant is cost. Remember Uber’s ClickHouse log system I mentioned above? They’re moving off ClickHouse. [Yupeng Fu](https://www.linkedin.com/in/yupeng-fu-593115b/) presented an excellent talk at [StarTree’s](https://startree.ai/)﹩ [RTA Summit 2024](https://www.rtasummit.com/) called [Evolution of OLAP at Uber](https://www.rtasummit.com/agenda/sessions/551916). The talk discusses how Uber is replacing several pieces of infrastructure, including ClickHouse, with Apache Pinot. ([View Highlight](https://read.readwise.io/read/01jd0f56k0fe4fp08x2sr22e7d))
- Yupeng says that Uber’s [log analytics platform](https://www.uber.com/blog/logging/) migration in 2020 resulted in 50% cost savings when compared to their previous ELK-based log analytics system. But ELK is very expensive to run on large datasets. A 50% gain isn’t really that much. Since the migration, the team has hit cost and performance challenges. Stories like these are somewhat alarming for large-scale enterprises. ([View Highlight](https://read.readwise.io/read/01jd0f5hdyeyc6gv7g0v3b4cd9))
- Another more subtle (and perhaps more minor) challenge with ClickHouse is its behavior with materialized views. Materialized views are important for many realtime analytics use cases. By updating aggregates when a write occurs, reads become very fast. Entire systems like [Materialize](https://materialize.com/) and [Feldera](https://www.feldera.com/) are built around this concept. ClickHouse supports materialized views, but updates are only triggered when the “main” table—the first table in a join—is written to. For many queries, especially those without joins, this is perfectly acceptable. But for more sophisticated use cases, it simply isn’t good enough. ([View Highlight](https://read.readwise.io/read/01jd0f5wz8nzjyrzx79mtf928z))
- And finally, the elephant in the room: PostgreSQL is becoming an OLAP system. [Hydra](https://hydra.so) recently published [pg_duckdb](https://github.com/duckdb/pg_duckdb) with backing from [MotherDuck](https://motherduck.com/), [Microsoft](https://www.microsoft.com/), [Neon](https://neon.tech/), and others. Hydra’s extension integrates DuckDB (an even *more* buzzy project than ClickHouse) with PostgresSQL. And [ParadeDB](https://www.paradedb.com/) has seen a lot of adoption with its [pg_lakehouse](https://www.paradedb.com/blog/introducing_lakehouse), [pg_analytics](https://github.com/paradedb/pg_analytics), and [pg_search](https://www.paradedb.com/blog/introducing_search) PostgreSQL extensions. ([View Highlight](https://read.readwise.io/read/01jd0f6h8kvm5r99jvtfhmthqf))
- As PostgreSQL’s OLAP extensions mature, it will be a great solution for the exact space that ClickHouse shines: single-node scale-up realtime OLAP with a great DX. If PostgreSQL takes ClickHouse’s single-node and small-scale usage, and systems like Pinot and Druid take its large-scale market, there’s not much left. This is the biggest long-term threat that I see for ClickHouse. ([View Highlight](https://read.readwise.io/read/01jd0f6ppcybpxvtk92r11cy3g))
- Still, as things stand now, ClickHouse is a robust system, and a reasonable solution for many use cases. I look forward to seeing how things shake out; I have a real soft spot for realtime analytics. ([View Highlight](https://read.readwise.io/read/01jd0f73ej4wefqvcrqn9spfav))
